# Origin - 工作流程指南

## 典型使用流程

### 场景一：创建一个登录页面

```
┌─────────────────────────────────────────────────────────────┐
│  1. 创建新项目                                               │
│     - 项目名称: "MyApp"                                      │
│     - 目标框架: Flutter                                      │
│     - 平台: iOS + Android + Web                              │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  2. 导入后端 API (可选)                                      │
│     - 导入 OpenAPI JSON                                     │
│     - 选择需要的 API 端点                                    │
│     - 系统自动生成类型定义                                   │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  3. 设计界面                                                 │
│     方式A: 传统设计                                         │
│       - 拖拽组件到画布                                      │
│       - 设置样式和属性                                      │
│                                                              │
│     方式B: AI 辅助设计                                      │
│       - 输入: "创建一个现代风格的登录页面"                   │
│       - AI 生成初始设计                                     │
│       - 用户进行微调                                        │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  4. 前端建模                                                 │
│     4.1 状态建模                                            │
│         - 标记输入字段: username, password                   │
│         - 定义状态变量: isLoading, errorMessage              │
│                                                              │
│     4.2 行为建模                                            │
│         - 配置登录按钮点击事件                               │
│         - 绑定 API 调用: auth.login                         │
│         - 定义成功/失败处理                                  │
│         - 配置页面跳转: 登录成功 → HomeScreen               │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  5. 预览与测试                                               │
│     - 实时预览 Flutter Widget                               │
│     - 测试交互流程                                          │
│     - 调整状态查看不同场景                                  │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  6. 生成代码                                                 │
│     - 点击 "Generate Code"                                  │
│     - 生成完整的 Flutter 项目                                │
│     - 包含: UI 组件、状态管理、API 调用、路由等              │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  7. 导出与部署                                               │
│     - 下载代码包                                             │
│     - 或直接推送到 Git 仓库                                 │
│     - 或触发 CI/CD 构建                                      │
└─────────────────────────────────────────────────────────────┘
```

### 场景二：使用 AI 快速创建完整页面

```
用户输入 (自然语言):
────────────────────────────────────────────────────────────
"创建一个商品列表页面，顶部有搜索框和筛选按钮，
列表展示商品卡片，每个卡片显示图片、标题、价格，
点击卡片跳转到商品详情页面，支持下拉刷新"
────────────────────────────────────────────────────────────

                            ↓
┌─────────────────────────────────────────────────────────────┐
│  AI 理解与生成                                               │
│     1. 分析需求:                                            │
│        - 页面类型: 列表页                                   │
│        - 组件: 搜索框、筛选按钮、卡片列表                   │
│        - 交互: 下拉刷新、点击跳转                           │
│                                                              │
│     2. 生成设计:                                            │
│        - 自动布局 (响应式)                                   │
│        - 推荐样式系统                                        │
│                                                              │
│     3. 建议建模:                                            │
│        - 状态: searchQuery, products, isLoading             │
│        - API: GET /api/products                             │
│        - 路由: ProductDetail(productId)                     │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  用户确认与调整                                              │
│     - 查看生成的页面                                         │
│     - 调整样式、布局                                         │
│     - 确认或修改 API 端点                                    │
│     - 确认或修改状态定义                                     │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  生成最终代码                                                │
│     - 完整的 Flutter 页面                                    │
│     - 包含所有状态管理和 API 调用                            │
└─────────────────────────────────────────────────────────────┘
```

## 核心概念

### 1. 组件 (Component)

可复用的 UI 元素，可以是：
- **基础组件**: Button, TextField, Container...
- **复合组件**: Card, ListItem, NavBar...
- **页面组件**: LoginScreen, HomeScreen...
- **自定义组件**: 用户定义的任何可复用元素

### 2. 状态 (State)

组件的动态数据，分为：
- **本地状态**: 仅在组件内部使用
- **共享状态**: 多个组件共享
- **全局状态**: 应用级别状态

### 3. 行为 (Action)

用户交互触发的操作：
- **UI 行为**: 导航、显示弹窗、滚动等
- **API 行为**: 网络请求调用
- **业务行为**: 表单验证、数据转换等

### 4. 建模 (Modeling)

为设计添加"行为语义"，让静态设计变成可交互的应用：
- **哪个字段是输入状态？**
- **点击后调用哪个 API？**
- **API 成功后做什么？**
- **失败如何处理？**
- **如何跳转到其他页面？**

## OpenAPI 集成流程

```
┌─────────────────────────────────────────────────────────────┐
│  1. 导入 OpenAPI 文档                                        │
│     - 支持格式: JSON / YAML                                 │
│     - 来源: URL / 文件上传 / 粘贴内容                        │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  2. 解析与验证                                               │
│     - 验证 OpenAPI 规范                                      │
│     - 提取端点、参数、响应模型                               │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  3. 生成类型定义                                             │
│     - Request/Response 类型                                  │
│     - 枚举、联合类型                                         │
│     - 验证规则                                               │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  4. 在设计中使用                                             │
│     - 绑定 API 到按钮点击                                   │
│     - 使用响应类型作为组件状态                               │
│     - 配置请求参数绑定                                       │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  5. 生成 API 调用代码                                        │
│     - 自动生成网络层                                        │
│     - 包含类型定义                                           │
│     - 错误处理                                               │
└─────────────────────────────────────────────────────────────┘
```

## 设计原则

### 1. 渐进式增强
- 从简单设计开始
- 逐步添加建模信息
- AI 始终可提供建议

### 2. 可视化优先
- 尽可能使用可视化界面
- 减少手写代码
- 所见即所得

### 3. AI 协作而非替代
- AI 提供建议和初稿
- 人类保持最终控制权
- 学习用户偏好

### 4. 设计即代码
- 设计和代码是同一事物的不同表示
- DSL 是中间桥梁
- 双向同步 (未来)
