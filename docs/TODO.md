# Origin - 开发任务清单

## 阶段 0: 项目初始化

### 基础设施
- [ ] 初始化 Rust 后端项目结构
- [ ] 初始化 React 前端项目结构
- [ ] 设置开发环境配置
- [ ] 配置 Git hooks (pre-commit, linting)
- [ ] 设置 CI/CD pipeline
- [ ] 配置开发 Docker compose

### 文档
- [ ] API 文档规范
- [ ] 代码风格指南
- [ ] 贡献指南
- [ ] README.md

---

## 阶段 1: 核心引擎 MVP

### 1.1 Document Engine (文档引擎)
**优先级: P0**

- [ ] 设计文档数据结构
  - [ ] Document, Page, Layer 基础结构
  - [ ] 图层树管理
  - [ ] 样式属性定义
- [ ] 序列化/反序列化
  - [ ] JSON 格式支持
  - [ ] 二进制格式支持 (未来)
- [ ] 增量更新机制
  - [ ] 操作定义 (Add, Update, Delete, Move)
  - [ ] 操作应用与回滚
- [ ] 基础存储层
  - [ ] PostgreSQL schema 设计
  - [ ] 数据库访问层 (sqlx)

### 1.2 Render Engine (渲染引擎)
**优先级: P0**

- [ ] 画布基础
  - [ ] Canvas 初始化
  - [ ] 坐标系统
  - [ ] 视口管理 (缩放、平移)
- [ ] 基础图形绘制
  - [ ] 矩形 (Rectangle)
  - [ ] 圆形/椭圆 (Ellipse)
  - [ ] 文本 (Text)
  - [ ] 图片 (Image)
  - [ ] 路径 (Path) - 未来
- [ ] 图层操作
  - [ ] 选择/多选
  - [ ] 移动、缩放、旋转
  - [ ] 图层顺序调整
  - [ ] 复制/粘贴/删除
- [ ] 样式系统
  - [ ] 填充 (Fill)
  - [ ] 描边 (Stroke)
  - [ ] 阴影 (Shadow)
  - [ ] 圆角 (Border Radius)

### 1.3 WebSocket 实时通信
**优先级: P0**

- [ ] WebSocket 服务器 (Rust)
  - [ ] 连接管理
  - [ ] 消息广播
  - [ ] 房间/会话管理
- [ ] WebSocket 客户端 (React)
  - [ ] 连接管理
  - [ ] 消息收发
  - [ ] 重连机制
- [ ] 协作状态同步
  - [ ] 操作转发
  - [ ] 状态合并

---

## 阶段 2: 基础设计功能

### 2.1 画布编辑器
**优先级: P0**

- [ ] 工具栏
  - [ ] 选择工具
  - [ ] 矩形工具
  - [ ] 椭圆工具
  - [ ] 文本工具
  - [ ] 图片上传
- [ ] 属性面板
  - [ ] 位置和尺寸
  - [ ] 填充和描边
  - [ ] 文本属性
  - [ ] 对齐和分布
- [ ] 图层面板
  - [ ] 图层树显示
  - [ ] 拖拽排序
  - [ ] 显示/隐藏
  - [ ] 锁定/解锁
- [ ] 页面管理
  - [ ] 创建/删除页面
  - [ ] 页面重命名
  - [ ] 页面切换

### 2.2 组件系统
**优先级: P1**

- [ ] 组件定义
  - [ ] 创建组件
  - [ ] 组件实例化
  - [ ] 组件属性覆盖
- [ ] 组件库
  - [ ] 内置基础组件
    - [ ] Button
    - [ ] TextField
    - [ ] CheckBox
    - [ ] Container
  - [ ] 自定义组件管理
- [ ] 组件复用
  - [ ] 拖拽实例化
  - [ ] 批量更新

---

## 阶段 3: DSL 与代码生成

### 3.1 DSL 设计与实现
**优先级: P0**

- [ ] DSL 语法设计
  - [ ] Component 定义
  - [ ] State 定义
  - [ ] Action 定义
  - [ ] Layout 定义
- [ ] DSL Parser
  - [ ] 词法分析
  - [ ] 语法分析
  - [ ] AST 构建
- [ ] DSL Generator
  - [ ] 从设计文档生成 DSL
  - [ ] 状态提取算法
  - [ ] 行为提取算法

### 3.2 Flutter 代码生成器
**优先级: P0**

- [ ] 模板系统
  - [ ] 模板引擎选择/实现
  - [ ] 组件模板库
  - [ ] 页面模板
- [ ] 代码生成
  - [ ] Widget 生成
  - [ ] 状态管理代码 (Riverpod/Bloc)
  - [ ] 路由代码
- [ ] 项目结构生成
  - [ ] 完整 Flutter 项目结构
  - [ ] pubspec.yaml 配置
  - [ ] 文件组织

### 3.3 OpenAPI 集成
**优先级: P1**

- [ ] OpenAPI Parser
  - [ ] JSON/YAML 解析
  - [ ] 规范验证
  - [ ] 端点提取
- [ ] 类型生成
  - [ ] Dart 类型定义
  - [ ] 枚举/模型生成
- [ ] API 调用代码生成
  - [ ] HTTP 客户端封装
  - [ ] 请求/响应序列化
- [ ] UI 集成
  - [ ] OpenAPI 导入界面
  - [ ] API 端点选择器
  - [ ] API 绑定配置

---

## 阶段 4: 前端建模系统

### 4.1 状态建模
**优先级: P1**

- [ ] 状态定义 UI
  - [ ] 状态变量添加
  - [ ] 类型选择
  - [ ] 默认值设置
- [ ] 状态绑定
  - [ ] 输入字段绑定
  - [ ] 显示字段绑定
- [ ] 状态可视化
  - [ ] 依赖关系图
  - [ ] 状态流追踪

### 4.2 行为建模
**优先级: P1**

- [ ] 事件配置
  - [ ] 事件类型 (onClick, onChange, etc.)
  - [ ] 事件处理器添加
- [ ] Action 配置
  - [ ] API 调用配置
  - [ ] 参数绑定
  - [ ] 成功/失败处理
  - [ ] 导航配置
- [ ] 交互流程可视化
  - [ ] 流程图显示
  - [ ] 调试模式

---

## 阶段 5: AI 功能

### 5.1 基础 AI 集成
**优先级: P2**

- [ ] LLM 集成
  - [ ] OpenAI API 接入
  - [ ] Claude API 接入
  - [ ] Prompt 模板管理
- [ ] 设计助手
  - [ ] 自然语言转 UI
  - [ ] 设计建议生成
  - [ ] 布局优化

### 5.2 智能建模
**优先级: P2**

- [ ] 自动状态识别
  - [ ] 输入字段自动检测
  - [ ] 状态类型推断
- [ ] 行为推断
  - [ ] 按钮行为建议
  - [ ] 导航关系分析

---

## 阶段 6: 预览与调试

### 6.1 实时预览
**优先级: P1**

- [ ] Flutter Preview
  - [ ] Widget 渲染
  - [ ] 热更新
  - [ ] 多设备预览
- [ ] 状态预览
  - [ ] 状态模拟
  - [ ] 交互测试

### 6.2 调试工具
**优先级: P2**

- [ ] DSL 调试器
- [ ] 生成代码预览
- [ ] 错误诊断

---

## 阶段 7: 高级功能

### 7.1 协作编辑
**优先级: P2**

- [ ] 多用户编辑
- [ ] 冲突解决
- [ ] 评论系统

### 7.2 版本管理
**优先级: P2**

- [ ] 版本历史
- [ ] 分支管理
- [ ] 变更对比

### 7.3 导出与集成
**优先级: P1**

- [ ] 代码导出
  - [ ] ZIP 下载
  - [ ] Git 推送
- [ ] CI/CD 集成
  - [ ] GitHub Actions
  - [ ] GitLab CI

---

## 未来考虑

- [ ] 多框架支持
  - [ ] React Native 生成器
  - [ ] SwiftUI 生成器
- [ ] 插件系统
- [ ] 云端部署
- [ ] 组件市场

---

## 当前 Sprint

### Sprint 1: 项目初始化 + 基础画布
**目标: 能够打开编辑器，绘制基本图形**

- [ ] Rust 后端项目初始化
- [ ] React 前端项目初始化
- [ ] Document Engine 基础结构
- [ ] 基础画布实现
- [ ] 矩形绘制
- [ ] WebSocket 连接
- [ ] 基础属性面板

### Sprint 2: 设计功能完善
**目标: 能够创建完整的设计稿**

- [ ] 完整图形工具集
- [ ] 图层面板
- [ ] 样式系统
- [ ] 页面管理
- [ ] 操作历史 (撤销/重做)

### Sprint 3: DSL MVP
**目标: 能够生成简单的 Flutter 代码**

- [ ] DSL 语法设计
- [ ] DSL Parser
- [ ] 基础 Flutter 生成器
- [ ] 简单页面代码生成

### Sprint 4: 建模系统
**目标: 能够为设计添加行为语义**

- [ ] 状态建模 UI
- [ ] 行为建模 UI
- [ ] DSL 行为扩展
- [ ] 带状态的代码生成

### Sprint 5: OpenAPI 集成
**目标: 能够对接后端 API**

- [ ] OpenAPI 导入
- [ ] 类型生成
- [ ] API 绑定
- [ ] API 调用代码生成
